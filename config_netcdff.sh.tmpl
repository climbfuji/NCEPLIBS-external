#!/usr/bin/env bash
set -x

ls -l ${NCDIR}/${CMAKE_INSTALL_LIBDIR}

CC=${CMAKE_C_COMPILER} \
FC=${CMAKE_Fortran_COMPILER} \
F77=${CMAKE_Fortran_COMPILER} \
CPPFLAGS="-I${NCDIR}/include  -I${H5DIR}/include -I${ZDIR}/include" \
LDFLAGS="-L${NCDIR}/${CMAKE_INSTALL_LIBDIR} -L${H5DIR}/${CMAKE_INSTALL_LIBDIR} -L${ZDIR}/${CMAKE_INSTALL_LIBDIR}" \
LIBS="-lnetcdf -lhdf5_hl -lhdf5 -lz" \
LD_LIBRARY_PATH="${NCDIR}/${CMAKE_INSTALL_LIBDIR}:${H5DIR}/${CMAKE_INSTALL_LIBDIR}:${ZDIR}/${CMAKE_INSTALL_LIBDIR}:${LD_LIBRARY_PATH}" \
${PROJECT_SOURCE_DIR}/netcdf-fortran/configure \
    --disable-shared \
    --prefix=${CMAKE_INSTALL_PREFIX} \
    --libdir=${CMAKE_INSTALL_PREFIX}/${CMAKE_INSTALL_LIBDIR}
